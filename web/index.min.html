<!doctypehtml><html lang=en><meta content="width=device-width,initial-scale=1"name=viewport><title>RSS</title><style>*{font-family:monospace;text-align:justify}@media only screen and (max-width:768px){body{font-size:1.2em}button,select{min-heigh:6em;min-width:3em}}button,select{padding:0 .5em;line-height:1.4em;border:1px solid #000;border-radius:3px;cursor:pointer;opacity:60%;text-align:center;display:inline-block;min-height:2em;min-width:2em}button:hover{opacity:100%}button.red{background-color:red;color:#fff}button.green{background-color:green;color:#fff}.closed{opacity:.5}img{width:100%;height:100%}main>*{padding:.5em}summary{cursor:pointer;list-style:none}summary::-webkit-details-marker,summary::marker{display:none}details{overflow-y:scroll;border-bottom:1px solid #000}details[open]{background-color:rgba(0,0,0,.1)}details>div{max-width:800px;margin:auto}details>div>table{font-size:1.2em;line-height:2em;border-collapse:collapse;width:100%;text-align:center}details>div>table th{border:1px solid #000}details>div>table th>*{width:100%;display:inline-block}</style><body x-data><template x-if=!$store.issues.authenticated><main><input @keyup.enter=$store.issues.authenticate($event.target.value) placeholder="password + enter"type=password></main></template><template x-if=$store.issues.authenticated><main><nav x-effect=$store.issues.fetch()><button @click.prevent="$store.issues.filter.page --">-</button><span x-text=$store.issues.filter.page></span><button @click.prevent="$store.issues.filter.page ++">+</button> <button @click.prevent="$store.issues.filter.open = !$store.issues.filter.open; $store.issues.filter.page = 1"x-text="$store.issues.filter.open ? 'open' : 'closed'"class="$store.issues.filter.open 'green': 'red' ?"></button> <template x-for="label in $store.issues.filter.labels"><button @click.prevent=$store.issues.toggle_label(label) x-text=label></button></template></nav><span x-show=$store.issues.loading>⏳</span><template x-for="issue in $store.issues.list"><details :class="{closed: issue.state === 'closed'}"><summary><div><button @click.prevent=$store.issues.toggle_open(issue) x-text="issue.state == 'open' ? '-' : '+'":class="issue.state === 'open' ? 'red': 'green'"></button> <template x-for="label in issue.labels"><button @click.prevent=$store.issues.toggle_label(label.name) x-text=label.name></button></template></div><h2 x-html=$store.issues.sanitize(issue.title)></h2></summary><div x-html=$store.issues.sanitize(issue.body)></div></details></template></main></template><script type=module>import Alpine from"https://cdn.skypack.dev/alpinejs";import{Octokit}from"https://cdn.skypack.dev/@octokit/rest";import dompurify from"https://cdn.skypack.dev/dompurify";import{marked}from"https://cdn.skypack.dev/marked";import{AES,enc}from"https://cdn.skypack.dev/crypto-js";dompurify.addHook("afterSanitizeAttributes",(function(t){"target"in t&&(t.setAttribute("target","_blank"),t.setAttribute("rel","noopener"))})),Alpine.store("issues",{authenticated:!1,loading:!0,filter:{open:!0,labels:[],page:1,per_page:10},list:[],index:-1,init(){window.Alpine=Alpine,document.addEventListener("keyup",(t=>{"KeyJ"===t.code&&this.move(1),"KeyK"===t.code&&this.move(-1),"KeyC"===t.code&&this.toggle_open(),"KeyO"===t.code&&this.open()}));const t=localStorage.getItem("password");t&&this.authenticate(t)},authenticate(t){try{const e=AES.decrypt("ENCRYPTED_TOKEN_TO_INJECT",t).toString(enc.Utf8)||(()=>{throw"couldn't decrypt token"})();this.rest=new Octokit({auth:e});const i=AES.decrypt("ENCRYPTED_REPOSITORY_TO_INJECT",t).toString(enc.Utf8)||(()=>{throw"couldn't decrypt repository"})();[this.owner,this.repo]=i.split("/")}catch(t){return void alert(`Invalid password: ${t}`)}localStorage.setItem("password",t),this.authenticated=!0,this.fetch()},open(){window.open(document.querySelector(`details:nth-of-type(${this.index+1}) table tr th:nth-of-type(2) a`).href,"_blank")},sanitize:t=>dompurify.sanitize(marked.parse(t)),move(t){this.index+=t,document.querySelectorAll("details").forEach(((t,e)=>{e===this.index?(t.setAttribute("open",!0),t.scrollIntoView()):t.removeAttribute("open")}))},fetch(){this.loading=!0,this.rest.issues.listForRepo({owner:this.owner,repo:this.repo,state:this.filter.open?"open":"closed",labels:this.filter.labels.join(","),page:this.filter.page,per_page:this.filter.per_page}).then((({data:t})=>this.list=t.filter((t=>t.body&&0!=t.body.length&&void 0===t.pull_request)))).catch(alert).finally((()=>this.loading=!1))},toggle_label(t){var e=this.filter.labels.indexOf(t);-1===e?this.filter.labels.push(t):this.filter.labels.splice(e,1),this.filter.page=1},toggle_open(t){(t=t||this.list[this.index]).state="open"===t.state?"closed":"open",this.rest.issues.update({owner:this.owner,repo:this.repo,issue_number:t.number,state:t.state}).catch(alert)}}),Alpine.start()</script>