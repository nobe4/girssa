<!doctypehtml><html lang=en><title>RSS</title><style>*{font-family:monospace}main>*{padding:.5em}button{border:1px solid #000;border-radius:3px;cursor:pointer;opacity:60%}button:hover{opacity:100%}button.red{background-color:red;color:#fff}button.green{background-color:green;color:#fff}summary{cursor:pointer;list-style:none}.closed{opacity:.5}details{border-bottom:1px solid #000}label{cursor:pointer}</style><body x-data><main><nav x-effect=$store.issues.fetch()><span x-show=$store.issues.loading>⏳ Loading</span><span x-show=!$store.issues.loading>✅ <span x-text="$store.issues.list.length + ' issues'"></span></span> <label for=open><input id=open type=checkbox x-model=$store.issues.filter.open> open</label> <template x-for="label in $store.issues.filter.labels"><button @click.prevent=$store.issues.toggle_label(label) x-text=label></button></template><span x-text=JSON.stringify($store.issues.filter)></span></nav><template x-for="issue in $store.issues.list"><details :class="{closed: issue.state === 'closed'}"><summary><div><button @click.prevent=$store.issues.toggle_open(issue) x-text="issue.state == 'open' ? '-' : '+'":class="issue.state === 'open' ? 'red': 'green'"></button> <template x-for="label in issue.labels"><button @click.prevent=$store.issues.toggle_label(label.name) x-text=label.name></button></template></div><strong x-text=issue.title></strong></summary><div x-html=$store.issues.sanitize(issue.body)></div></details></template></main><script type=module>import Alpine from"https://cdn.skypack.dev/alpinejs";import{Octokit}from"https://cdn.skypack.dev/@octokit/rest";import{paginateRest}from"https://cdn.skypack.dev/@octokit/plugin-paginate-rest";import dompurify from"https://cdn.skypack.dev/dompurify";const token="XXX",repository="XXX",{rest:rest,paginate:paginate}=new(Octokit.plugin(paginateRest))({auth:"XXX"}),[owner,repo]="XXX".split("/");let store;document.addEventListener("keyup",(function(e){"KeyJ"===e.code&&store.move(1),"KeyK"===e.code&&store.move(-1),"KeyC"===e.code&&store.toggle_open()})),Alpine.store("issues",{loading:!0,filter:{open:!0,labels:[]},list:[],index:-1,init(){this.fetch(),store=this,window.Alpine=Alpine},open(){console.log(this.list[this.index])},sanitize:e=>dompurify.sanitize(e),move(e){this.index+=e,document.querySelectorAll("details").forEach(((e,t)=>{t===this.index?(e.setAttribute("open",!0),e.scrollIntoView()):e.removeAttribute("open")}))},fetch(){this.loading=!0,paginate(rest.issues.listForRepo,{owner:owner,repo:repo,state:this.filter.open?"open":"closed",labels:this.filter.labels.join(",")}).then((e=>this.list=e.filter((e=>e.body&&0!=e.body.length&&void 0===e.pull_request)))).catch(alert).finally((()=>this.loading=!1))},toggle_label(e){var t=this.filter.labels.indexOf(e);-1===t?this.filter.labels.push(e):this.filter.labels.splice(t,1)},toggle_open(e){(e=e||this.list[this.index]).state="open"===e.state?"closed":"open",rest.issues.update({owner:owner,repo:repo,issue_number:e.number,state:e.state}).then(console.log).catch(alert)}}),Alpine.start()</script>