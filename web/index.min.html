<!doctypehtml><html lang=en><title>RSS</title><style>*{font-family:monospace}main>*{padding:.5em}button{line-height:1.4em;border:1px solid #000;border-radius:3px;cursor:pointer;opacity:60%}button:hover{opacity:100%}button.red{background-color:red;color:#fff}button.green{background-color:green;color:#fff}summary{cursor:pointer;list-style:none}.closed{opacity:.5}label{cursor:pointer}details{border-bottom:1px solid #000}details>div>table{font-size:1.2em;line-height:2em;border-collapse:collapse;width:100%}details>div>table th{border:1px solid #000}details>div>table th>*{width:100%;display:inline-block}</style><body x-data><template x-if=!$store.issues.authenticated><main><input type=password @keyup.enter=$store.issues.authenticate($event.target.value) placeholder="password + enter"></main></template><template x-if=$store.issues.authenticated><main><nav x-effect=$store.issues.fetch()><span x-show=$store.issues.loading>⏳ Loading</span><span x-show=!$store.issues.loading>✅ <span x-text="$store.issues.list.length + ' issues'"></span></span> <label for=open><input type=checkbox id=open x-model=$store.issues.filter.open> open</label> <template x-for="label in $store.issues.filter.labels"><button @click.prevent=$store.issues.toggle_label(label) x-text=label></button></template></nav><template x-for="issue in $store.issues.list"><details :class="{closed: issue.state === 'closed'}"><summary><div><button @click.prevent=$store.issues.toggle_open(issue) x-text="issue.state == 'open' ? '-' : '+'":class="issue.state === 'open' ? 'red': 'green'"></button> <template x-for="label in issue.labels"><button @click.prevent=$store.issues.toggle_label(label.name) x-text=label.name></button></template></div><h3 x-text=issue.title></h3></summary><div x-html=$store.issues.render_body(issue.body)></div></details></template></main></template><script type=module>import Alpine from"https://cdn.skypack.dev/alpinejs";import{Octokit}from"https://cdn.skypack.dev/@octokit/rest";import{paginateRest}from"https://cdn.skypack.dev/@octokit/plugin-paginate-rest";import dompurify from"https://cdn.skypack.dev/dompurify";import{marked}from"https://cdn.skypack.dev/marked";import{AES,enc}from"https://cdn.skypack.dev/crypto-js";dompurify.addHook("afterSanitizeAttributes",(function(t){"target"in t&&(t.setAttribute("target","_blank"),t.setAttribute("rel","noopener"))})),Alpine.store("issues",{authenticated:!1,loading:!0,filter:{open:!0,labels:[]},list:[],index:-1,init(){window.Alpine=Alpine,document.addEventListener("keyup",(t=>{"KeyJ"===t.code&&this.move(1),"KeyK"===t.code&&this.move(-1),"KeyC"===t.code&&this.toggle_open(),"KeyO"===t.code&&this.open()}));const t=localStorage.getItem("password");t&&(console.log("Found password in localstorage"),this.authenticate(t))},authenticate(t){try{const e=AES.decrypt("ENCRYPTED_TOKEN_TO_INJECT",t).toString(enc.Utf8)||(()=>{throw"couldn't decrypt token"})(),{rest:i,paginate:o}=new(Octokit.plugin(paginateRest))({auth:e});this.rest=i,this.paginate=o;const s=AES.decrypt("ENCRYPTED_REPOSITORY_TO_INJECT",t).toString(enc.Utf8)||(()=>{throw"couldn't decrypt repository"})();[this.owner,this.repo]=s.split("/")}catch(t){return void alert(`Invalid password: ${t}`)}localStorage.setItem("password",t),this.authenticated=!0,this.fetch()},open(){window.open(document.querySelector(`details:nth-of-type(${this.index+1}) table tr th:nth-of-type(2) a`).href,"_blank")},render_body:t=>dompurify.sanitize(marked.parse(t)),move(t){this.index+=t,document.querySelectorAll("details").forEach(((t,e)=>{e===this.index?(t.setAttribute("open",!0),t.scrollIntoView()):t.removeAttribute("open")}))},fetch(){this.loading=!0,this.paginate(this.rest.issues.listForRepo,{owner:this.owner,repo:this.repo,state:this.filter.open?"open":"closed",labels:this.filter.labels.join(",")}).then((t=>this.list=t.filter((t=>t.body&&0!=t.body.length&&void 0===t.pull_request)))).catch(alert).finally((()=>this.loading=!1))},toggle_label(t){var e=this.filter.labels.indexOf(t);-1===e?this.filter.labels.push(t):this.filter.labels.splice(e,1)},toggle_open(t){(t=t||this.list[this.index]).state="open"===t.state?"closed":"open",this.rest.issues.update({owner:this.owner,repo:this.repo,issue_number:t.number,state:t.state}).then(console.log).catch(alert)}}),Alpine.start()</script>